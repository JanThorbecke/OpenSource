--------------------------
Code to reproduce the example in section `Plane-Wave Marchenko algorithm` of the manual.
--------------------------

Description of files:

1) ./model.scr computes the gridded velocity/density model 

2) ./shots.scr computes 601 shots using slurm arrays: ~100 s runtime for each shot

3) ./direct.scr compute 1 shot that contains direct wave only
   
4) ./remove_direct.scr removes the direct wave from the data created in 3 and places all shots in one file shots/refl_rp.su 

   Figures of the model and the middle shot are generated by
   ./epsModel.scr model

5) ./IniFocus.scr compute plane wave responses at 600 m depth with angles -5 0 and 5 degrees.

   To compute the plane wave respone with the sources all starting at t=0 on a slanted line in the model run

   ./Ini2Focus.scr

   To generate 12 snapshot figures based on the results of Ini(2)Focus.scr

   ./epsModel.scr snapshots

*** Steps to generate the Marchenko plane wave results.

6) To generate the Marchenko results for plane wave with angle=0 (horizontal)

./marchenkoPlaneIter.scr plane0
./epsModel.scr plane0

[ 7) Marchenko with and without time-shifts in a one-D model: requires shift to build in again in marchenko code: does not generate correct results at the moment
   cd shifts
   compute 1D model, f_d and marchenko with and without shift
   ./model.scr
   ./initialFocus.scr
   ./marchenko.scr
   ./eps.scr
]

8) Generating the mute windows for angle 5 and -5 for odd and even iterations 

./epsModel.scr mutewindow


9) Generating the Marchenko results for angle 5 and -5 for odd and even iterations 
./marchenkoPlaneIter.scr plane5
./epsModel.scr.scr plane5




optional scripts not needed to reproduce the figures:
+) clean: remove all produced files and start with a clean directory


