--------------------------
The instructions below explain how to reproduce the results in the paper:

"Design, implementation and application of the Marchenko Plane-wave algorithm"

by Jan Thorbecke, Mohammed Almobarak, Johno van IJsseldijk, Joeri Brackenhoff, Giovanni Meles, Kees Wapenaar.
--------------------------

#Figure 1: model lateral varying created by Giovanni Meles
cd marchenko/demo/planewave/twoD
# this creates the gridded models
./model.scr
# to create the eps figures
./epsModel.scr model

#Figure 2: time-window seperation point-source algorithm
cd marchenko/demo/planewave/twoD
#First generate all 601 shots to model the reflection data R from the model of Figure 1
./shots.scr #this script is based on slurm
#model direct field
./direct.scr
#subtract direct field from modeled shots to create Reflection data in shots/refl_cp.su
./remove_direct.scr

#Figure 2
# initial modeling for first arrival
./IniPoint.scr
#run the marchenko algorithm for a point in the middle at 800 m depth and create figure 2
./sumGandFpoint.scr

#Figure 4 same as figure 2 but now for plane-waves
#first model the first arrivals of the plane-wave response
./IniFocus.scr
#run plane-wave marchenko with plane-wave of 5 degrees and generate picture
sumGandF.scr

#Figure 5 (1D model + middle shot)
cd marchenko/demo/planewave/oneD
./model.scr
./epsModel.scr 

#Figure 6 & 7 : plane wave snapshots angle 0 and 3 in 1D medium
cd marchenko/demo/planewave/oneD
./initialFocusPlane.scr
./marchenkoPlane.scr
./backpropf1plusPlane.scr
./epsPlane.scr plane
./epsPlane.scr snapshots

#Figure 8 (see figure 1 for generating data)
cd marchenko/demo/planewave/twoD
./model.scr
./IniFocus.scr (for 0 5 and -5)
./marchenkoPlaneIter.scr (for 0 5 and -5)
#back propagating snapshots through Giovanni's Model
./backpropf1plusPlane.scr
./epsPlane.scr snapshots

#Figure 9
./epsPlane.scr shots0

#Figure 10: use fmute with returnmask=1 
cd marchenko/demo/planewave/twoD
./muteW.scr
./epsModel.scr mute

#Figure 11
cd marchenko/demo/planewave/twoD
./epsPlane.scr shots5
./epsPlane.scr iter

#Figure 12
cd marchenko/demo/planewave/twoD
./epsPlane.scr shots5
./epsPlane.scr shots0
./epsPlane.scr shots-5


#Figure 13 Troll data field
Not provided have to ask permission for sharing data to Equinor


--------------------------
--------------------------

Description of files:

1) ./model.scr computes the gridded velocity/density model 

2) ./shots.scr computes 601 shots using slurm arrays: ~100 s runtime for each shot

3) ./direct.scr compute 1 shot that contains direct wave only
   
4) ./remove_direct.scr removes the direct wave from the data created in 3 and places all shots in one file shots/refl_rp.su 

   Figures of the model and the middle shot are generated by
   ./epsModel.scr model

5) ./IniFocus.scr compute plane wave responses at 800 m depth with angles -5 0 and 5 degrees.

   To compute the plane wave respone with the sources all starting at t=0 on a slanted line in the model run

   ./IniFocus.scr

